{% comment %}
TODOs:
  - Support ARIA (https://www.w3.org/WAI/tutorials/forms/labels/, https://www.w3.org/TR/wai-aria-practices/#radiobutton).
      - Where prices are shown, add visually hidden labels for screen readers.  They'll look like this:
      <span class="visually-hidden">{{ "cart.label.discounted_price" | t }}</span> {{ item.price | money }}
      <span class="visually-hidden">{{ "cart.label.original_price" | t }}</span> <s>{{ item.original_price | money }}</s>
  - Ajaxify the shopping bag in the product.liquid section.
  - For permalinks that pre-populate a cart, see https://help.shopify.com/en/themes/customization/cart/use-permalinks-to-preload-cart/.
  - For links that load additional items to the cart, see https://ecommerce.shopify.com/c/ecommerce-design/t/add-to-cart-link-274987
  - Limit quantity updates to what's available in inventory.
  - Learn about Script Editor, create any necessary ones, and review how changes in price are applied to this page.
  - Make sure the cart is tied to customer account, so that persistent cart across devices is supported.
  - Rework empty shopping bag.
  - Implement shopping bag drawer off header.
  - Figure out how/where/when to use properties.  Here's the snippet we did not want to lose:  {%- assign property_size = item.properties | size -%}{% if property_size > 0 %}{% for p in item.properties %}{% unless p.last == blank %}{{ p.first }}:{% if p.last contains '/uploads/' %}<a href="{{ p.last }}">{{ p.last | split: '/' | last }}</a>{% else %}{{ p.last }}{% endif %}{% endunless %}{% endfor %}{% endif %}
  - Same thing with cart notes.  Look at the original Slate code.
  - When we implement discounts, this must be added to totals section of the table (where all ._t-* classes are):  {% if cart.total_discounts > 0 %}<p>{{ "cart.general.savings" | t }} {{ cart.total_discounts | money }}</p>{% endif %}
  - BUG: Info column header does not disappear in narrow screens.
  - BUG: See Ling Dress s3, it reads "You save $-3.00!".  Use the import file c:\temp\ProductData_Ling.csv.
  
{% endcomment %}
<div data-section-id="{{ section.id }}" data-section-type="cart" id="_DBG-cart">

{% unless cart.item_count > 0 %}

  <h1>{{ "cart.general.title" | t }}</h1>

  {% comment %} Cart empty state. {% endcomment %}
  <div class="supports-cookies">
    <p>{{ 'cart.general.empty' | t }}</p>
    <p>{{ 'cart.general.continue_browsing_html' | t }}</p>
  </div>

  {% comment %} Cart no-cookies state.
  Cookies are required to use the cart. If cookies are not enabled, prompt user to enable them.
  {% endcomment %}
  <div class="supports-no-cookies">
    <p>{{ 'cart.general.cookies_required' | t }}</p>
  </div>

{% else %}

  <form action="/cart" method="post" id="_f-cart">

    <div class="_cart-buybox">
      <div class="_buybox-summary">Shopping cart subtotal ({{ cart.item_count }} {{ cart.item_count | pluralize: "item", "items" }}): <b>{{ cart.total_price | money }}</b></div>
      <input type="submit" form="_f-cart" name="checkout" class="_checkout-button _bp-checkout-button" value="{{ "cart.general.checkout" | t }}" />
    </div>

    <div class="_cart">
      <div class="_h-item">Item</div>
      <div class="_h-description">Description</div>
      <div class="_h-info _bp-info">Info</div>
      <div class="_h-price _bp-price">Price</div>
      <div class="_h-quantity">Quantity</div>
      <div class="_h-subtotal">Subtotal</div>

      <div class="_line"></div>

      {%- for item in cart.items -%}

      <div class="_image">
        <div class="_thumbnail">
          <img class="_image" src="{{ item.image | img_url: "small" }}" />
        </div>
      </div>

      <div class="_description">
        <div><b>{{ item.product.title }}</b></div>
        <div class="_text-small">{{ item.variant.title }}</div> {% comment %} To render the option labels and their values (e.g. "Color Indigo"):  {%- for i in (0..2) -%}{%- if item.variant.options[i] -%}{{- item.product.options_with_values[i].name }} {{ item.variant.options[i] -}}{%- endif -%}{%- endfor -%} {% endcomment %}
      </div>

      <div class="_info _bp-info _text-gray">
      {% if item.price != item.variant.compare_at_price %}
        <div class="_text-small">From <s>{{ item.variant.compare_at_price | money }}</s></div>
        <div class="_text-small">You save {{ item.variant.compare_at_price | minus: item.price | money }}!</div>
      {% endif %}
      {%- if "deny" == item.variant.inventory_policy and item.quantity >= item.variant.inventory_quantity %}
          {% if item.quantity == 1 %}
        <div class="_text-small">Only one in stock!</div>
          {% elsif item.quantity == item.variant.inventory_quantity %}
        <div class="_text-small">Only {{ item.variant.inventory_quantity }} left in stock!</div>
          {% elsif item.quantity > item.variant.inventory_quantity %}
        <div class="_text-small">Hmmm...only {{ item.variant.inventory_quantity }} in stock...</div>
          {% endif %}
      {% endif %}
      </div>

      <div class="_price _bp-price">
        {{ item.price | money }}
      </div>

      <div class="_quantity">
        <div class="_spinner _js-spinner">
          <span class="_label _js-label">&times;&nbsp;{{ item.quantity }}</span>
          <button type="submit" class="_button _js-button" data-action="decrement">&ndash;</button>
          <button type="submit" class="_button _js-button" data-action="increment" {% if "deny" == item.variant.inventory_policy and item.quantity >= item.variant.inventory_quantity %}disabled{% endif %}>+</button>
          <input type="hidden" form="_f-cart" name="updates[]" value="{{ item.quantity }}" class="_input _js-input" />
        </div>
      </div>

      <div class="_subtotal">
        <b>{{ item.line_price | money }}</b>
      </div>

      <div class="_actions _bp-actions">
        <a href="/cart/change?line={{ forloop.index }}&amp;quantity=0">
          {% include "icons", icon: "remove", class: "_icon" %}
        </a>
      </div>

      <div class="_extras _bp-extras _text-gray">
        <div class="_horizontal-bullets _text-small">
          <ul>
            <li class="_bp-extras-price">{{ item.price | money }}</li>
          {% if item.price != item.variant.compare_at_price %}
            <li class="_bp-extras-original-price">From <s>{{ item.variant.compare_at_price | money }}</s></li>
          {% endif %}
          {%- if "deny" == item.variant.inventory_policy and item.quantity >= item.variant.inventory_quantity %}
            <li class="_bp-extras-info">
            {% if item.quantity == 1 %}
              <span>Only one left</span>
            {% elsif item.quantity == item.variant.inventory_quantity %}
              <span>Only {{ item.variant.inventory_quantity }} left</span>
            {% elsif item.quantity > item.variant.inventory_quantity %}
              <span>Hmmm...{{ item.variant.inventory_quantity }} left</span>
            {% endif %}
            </li>
          {% endif %}
            <li><a href="/cart/change?line={{ forloop.index }}&amp;quantity=0">{{ "cart.general.remove" | t }}</a></li>
          </ul>
        </div>
      </div>

      <div class="_line"></div>

      {%- endfor -%}

      <div class="_f-summary">
        <div>{{ "cart.general.subtotal" | t }}</div>
        <div><b>{{ cart.total_price | money }}</b></div>
      </div>
      <div class="_f-summary">
        <div>Shipping</div>
        <div>Free</div>
      </div>
      <div class="_f-summary">
        <div>Taxes</div>
        <div>Calculated at checkout</div>
      </div>
      <div class="_line"></div>
      <div class="_f-summary">
        <div class="_text-large">Total</div>
        <div class="_text-xxxlarge"><b>{{ cart.total_price | money }}</b></div>
      </div>

    </div>

    <input type="submit" form="_f-cart" name="checkout" class="_checkout-button _bp-checkout-button" value="{{ 'cart.general.checkout' | t }}" />

  </form>

  <br/></br>

{% endunless %}

</div>

{% schema %}
  {
    "name": "Cart page",
    "settings": [
      {
        "type": "checkbox",
        "id": "cart_notes_enable",
        "label": "Enable cart notes",
        "default": false
      }
    ]
  }
{% endschema %}
